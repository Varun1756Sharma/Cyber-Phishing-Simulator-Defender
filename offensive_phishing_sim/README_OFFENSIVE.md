# Offensive Tool — Phishing Simulation (Training Page)

## Purpose
This module implements a **lab-only phishing simulator**: it generates harmless phishing-style `.eml` files, sends them to a local SMTP capture (MailHog), and hosts a local training page (Flask) that records simulated submissions. All actions are restricted to the lab.

## Contents
- `run_simulator.sh` — safe wrapper with environment checks and send logic
- `generate_email.py` — creates `.eml` files in `artifacts/`
- `flask_receiver.py` — simple Flask training page (POST logs to `artifacts/submissions.csv`)
- `whitelist.json` — allowed hostnames
- `recipient_whitelist.txt` — allowed recipient addresses
- `artifacts/` — generated emails, startup logs, and submissions

## Pre-requisites (lab ONLY)
- Isolated VM or container (no public internet).
- MailHog (or equivalent) listening on `127.0.0.1:1025`.
  - Docker quick start:
    ```bash
    docker run -d --name mailhog -p 1025:1025 -p 8025:8025 mailhog/mailhog
    ```
- Python 3.6+ and venv:
  ```bash

  cd offensive_phishing_sim
python3 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install flask
chmod +x run_simulator.sh

Configure safeties
export LAB_TOKEN="faculty-provided-token"

Run training page
cd offensive_phishing_sim
source venv/bin/activate
python3 flask_receiver.py
# Training page: http://127.0.0.1:8000/phish

Generate & send a simulated phishing email
cd offensive_phishing_sim
export LAB_TOKEN="faculty-provided-token"
./run_simulator.sh testuser@local.lab

Manual generation (optional)
python3 generate_email.py testuser@local.lab
# created file in artifacts/

Troubleshooting

---

**defensive_stack/README_DEFENSE.md**
```markdown
# Defensive Stack — Email Filter & Domain Similarity Detector

## Purpose
This folder implements a simple offline defensive toolkit that inspects `.eml` files (produced by the offensive simulator) and classifies them as SAFE / SUSPICIOUS / PHISHING. PHISHING messages are copied to `quarantine/` and an `alerts.log` entry is created.

## Contents
- `domain_similarity_detector.py` — fuzzy-match domains (typosquatting detection)
- `email_filter.py` — scoring engine; quarantines or logs messages
- `deploy_defense.sh` — prepares venv and directories
- `quarantine_actions.sh` — copy + log helper
- `logs/` — alert & filter logs
- `quarantine/` — quarantined `.eml` files

## Pre-requisites
- Python 3.6+ (preferably same venv used for offensive side)
- No network access required; this tool works on local `.eml` files only

## Setup
```bash
cd defensive_stack
chmod +x deploy_defense.sh quarantine_actions.sh
./deploy_defense.sh
source venv/bin/activate

How to test (one-off)

Use an .eml generated by the offensive simulator, e.g.:
offensive_phishing_sim/artifacts/email-<ts>.eml

Run the filter:

python3 email_filter.py ../offensive_phishing_sim/artifacts/email-<ts>.eml
  sudo apt update
  sudo apt install -y python3 python3-venv python3-pip netcat
